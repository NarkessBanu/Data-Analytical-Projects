											SQL Basics

Creating a table

CREATE TABLE employees (
emp_id INT PRIMARY KEY, 
name VARCHAR(50), 
department VARCHAR(30), 
salary INT, 
hire_date DATE 
);

Result 
emp_id	name	department	salary	hire_date

Insert Values into tables

INSERT INTO employees (emp_id, name, department, salary, hire_date) VALUES
(1, 'Asha Rao', 'HR', 35000, '2021-05-12'),
(2, 'Ravi Kumar', 'Finance', 42000, '2020-03-20'),
(3, 'Maya Iyer', 'IT', 55000, '2022-07-15'),
(4, 'John Doe', 'IT', 60000, '2019-11-01'),
(5, 'Fatima Khan', 'HR', 37000, '2023-01-10'),
(6, 'Arjun Singh', 'Finance', 48000, '2021-09-05'),
(7, 'Priya Sharma', 'IT', 52000, '2020-12-18');

Result
emp_id	name	department	salary	hire_date
1	Asha Rao	HR	35000	2021-05-12
2	Ravi Kumar	Finance	42000	2020-03-20
3	Maya Iyer	IT	55000	2022-07-15
4	John Doe	IT	60000	2019-11-01
5	Fatima Khan	HR	37000	2023-01-10
6	Arjun Singh	Finance	48000	2021-09-05
7	Priya Sharma	IT	52000	2020-12-18

Select a particular column

select name, department , salary from employees; 

Result
name	department	salary
Asha Rao	HR	35000
Ravi Kumar	Finance	42000
Maya Iyer	IT	55000
John Doe	IT	60000
Fatima Khan	HR	37000
Arjun Singh	Finance	48000
Priya Sharma	IT	52000

 Filtering using Where

 select name, department , salary from employees 
 where department ="IT" ; 

Result
name	department	salary
Maya Iyer	IT	55000
John Doe	IT	60000
Priya Sharma	IT	52000

Comparing using operators

select * from employees 
where salary > 45000; 

Result
emp_id	name	department	salary	hire_date
3	Maya Iyer	IT	55000	2022-07-15
4	John Doe	IT	60000	2019-11-01
6	Arjun Singh	Finance	48000	2021-09-05
7	Priya Sharma	IT	52000	2020-12-18

Sorting

select name, department , salary from employees 
order by salary desc; 

Result
name	department	salary
John Doe	IT	60000
Maya Iyer	IT	55000
Priya Sharma	IT	52000
Arjun Singh	Finance	48000
Ravi Kumar	Finance	42000
Fatima Khan	HR	37000
Asha Rao	HR	35000

Fetch first 5 data

 select name, department , salary from employees 
 limit 5; 

Result
name	department	salary
Asha Rao	HR	35000
Ravi Kumar	Finance	42000
Maya Iyer	IT	55000
John Doe	IT	60000
Fatima Khan	HR	37000

Mini-task “Get all employees where Salary > 55000 in IT.”

 select name , department, salary from employees 
 where department = 'IT' and salary >=55000;

Result
name	department	salary
Maya Iyer	IT	55000
John Doe	IT	60000

Sort top 10 highest sales

 select name , department, salary from employees 
 order by salary desc 
 limit 5; 

Result
name	department	salary
John Doe	IT	60000
Maya Iyer	IT	55000
Priya Sharma	IT	52000
Arjun Singh	Finance	48000
Ravi Kumar	Finance	42000

Distinct department list

 select distinct(department) from employees; 

Result
department
HR
Finance
IT

Hire_date between

 select name, department from employees 
 where hire_date between  '2021-01-01' and '2023-12-31';

Result
name	department
Asha Rao	HR
Maya Iyer	IT
Fatima Khan	HR
Arjun Singh	Finance

Mini-task "Find employees where Name starts with ‘A’ and Salary > 30000"

 select * from employees 
 where name like 'A%' and salary >30000; 

Result
emp_id	name	department	salary	hire_date
1	Asha Rao	HR	35000	2021-05-12
6	Arjun Singh	Finance	48000	2021-09-05

Aggregation
Min & Max

select max(salary) as Highest_Salary, 
min(salary) as Lowest_Salary 
from employees; 

Result
Highest_Salary	Lowest_Salary
60000	35000

Sum, Avg & Count

select count(name) as Total_emp, 
sum(salary) as Total_salary, 
round(avg(salary)) as Avg_salary 
from employees; 

Result
Total_emp	Total_salary	Avg_salary
7	329000	47000

Groupby
Each department’s employee count and average salary

 select department, count(name),round(avg(salary)) as Avg_salary from employees 
 group by department; 

Result

department	count(name)	Avg_salary
HR	2	36000
Finance	2	45000
IT	3	55667

Only departments with avg salary > 40,000

 select department, round(avg(salary)) as Avg_salary from employees 
 group by department 
 having avg(salary)> 40000; 

Result
department	Avg_salary
Finance	45000
IT	55667

Total salary per department

 select department, sum(salary) as Total_salary from employees 
 group by department; 

Result
department	Total_salary
HR	72000
Finance	90000
IT	167000

Mini-task " Find department with highest average salary"

 select department, round(avg(salary)) from employees 
 group by department 
 order by avg(salary) desc 
 limit 1; 

Result
department	round(avg(salary))
IT	55667


									 SQL joins
					
Create a department and employee table


CREATE TABLE departments (
  dept_id INT PRIMARY KEY,
  dept_name VARCHAR(30),
  location VARCHAR(30)
);

INSERT INTO departments (dept_id, dept_name, location) VALUES
(1, 'HR', 'Delhi'),
(2, 'Finance', 'Mumbai'),
(3, 'IT', 'Bengaluru'),
(4, 'Marketing', 'Chennai');

CREATE TABLE employees (
  emp_id INT PRIMARY KEY,
  name VARCHAR(50),
  dept_id INT,
  salary INT,
  hire_date DATE,
  FOREIGN KEY (dept_id) REFERENCES departments(dept_id)
);

INSERT INTO employees (emp_id, name, dept_id, salary, hire_date) VALUES
(1, 'Asha Rao', 1, 35000, '2021-05-12'),
(2, 'Ravi Kumar', 2, 42000, '2020-03-20'),
(3, 'Maya Iyer', 3, 55000, '2022-07-15'),
(4, 'John Doe', 3, 60000, '2019-11-01'),
(5, 'Fatima Khan', 1, 37000, '2023-01-10'),
(6, 'Arjun Singh', 2, 48000, '2021-09-05'),
(7, 'Priya Sharma', 3, 52000, '2020-12-18');


1.Shows employees with their department names.

 select e.name,d.dept_name from employees e inner join departments d 
 on e. dept_id = d. dept_id; 

Result
name	dept_name
Asha Rao	HR
Fatima Khan	HR
Ravi Kumar	Finance
Arjun Singh	Finance
Maya Iyer	IT
John Doe	IT
Priya Sharma	IT

2.Includes all employees; if no matching department → NULL.(Left Join)

 select e. name,d .dept_name from employees e left join departments d 
 on e. dept_id = d. dept_id; 

Result
name	dept_name
Asha Rao	HR
Ravi Kumar	Finance
Maya Iyer	IT
John Doe	IT
Fatima Khan	HR
Arjun Singh	Finance
Priya Sharma	IT

3.Shows all departments; even those with no employees.(Right join)

select e. name,d .dept_name from employees e right join departments d 
on e. dept_id = d. dept_id; 

Result
name	dept_name
Asha Rao	HR
Fatima Khan	HR
Ravi Kumar	Finance
Arjun Singh	Finance
Maya Iyer	IT
John Doe	IT
Priya Sharma	IT
null	Marketing

4.Employees in IT department only

 select e.name,d.dept_name from employees e inner join departments d 
 on e. dept_id = d. dept_id 
 where d.dept_name= 'IT'; 

Result
name	dept_name
Maya Iyer	IT
John Doe	IT
Priya Sharma	IT

5.Count employees per department

 select d.dept_name,count(d.dept_name) from employees e left join departments d 
 on e. dept_id = d. dept_id 
 group by (d.dept_name); 

Result
dept_name	count(d.dept_name)
HR	2
Finance	2
IT	3

6.Find highest paid employee in each department (with JOIN + GROUP BY)

 select d.dept_name,max(e.salary) from employees e join departments d 
 on e. dept_id = d. dept_id 
 group by d. dept_name; 

Result
dept_name	max(e.salary)
HR	37000
Finance	48000
IT	60000

7.Employee list with department location

 select e.name,d.dept_name,d.location from employees e inner join departments d 
 on e. dept_id = d. dept_id 
 order by d. location; 

Result
name	dept_name	location
Maya Iyer	IT	Bengaluru
John Doe	IT	Bengaluru
Priya Sharma	IT	Bengaluru
Asha Rao	HR	Delhi
Fatima Khan	HR	Delhi
Ravi Kumar	Finance	Mumbai
Arjun Singh	Finance	Mumbai




 
























































 











